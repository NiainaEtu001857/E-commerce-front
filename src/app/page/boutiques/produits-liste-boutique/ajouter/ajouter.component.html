<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-12">
            <!-- Header -->
            <div class="header">
                <div class="header-body">
                    <div class="row align-items-center">
                        <div class="col">

                        <!-- Pretitle -->
                        <h6 class="header-pretitle">
                            Overview
                        </h6>

                        <!-- Title -->
                        <h1 class="header-title text-truncate">
                            Ajouter un produit
                        </h1>

                        </div>
                    </div> <!-- / .row -->
                </div>
            </div>
            <div class="card">
                <div class="card-body">
                    <form class="mt-3" (ngSubmit)="submit($event)">

                    <div class="row g-3">

                        <!-- Nom du produit -->
                        <div class="col-12 col-md-6">
                        <label class="form-label">Nom du produit</label>
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Ex: Télévision Samsung"
                            [(ngModel)]="productForm.name"
                            name="name"
                            required
                        >
                        </div>

                        <!-- Catégorie -->
                        <div class="col-12 col-md-6">
                        <label class="form-label">Catégorie</label>
                        <select
                            class="form-select"
                            [(ngModel)]="productForm.category"
                            name="category"
                            required
                        >
                            <option value="">Choisir une catégorie</option>
                            <option value="Électronique">Électronique</option>
                            <option value="Vêtements">Vêtements</option>
                            <option value="Alimentation">Alimentation</option>
                            <option value="Chaussures">Chaussures</option>
                        </select>
                        </div>
                                             <!-- Image principale -->
                        <div class="col-12 col-md-6">
                        <label class="form-label">Image principale</label>
                        <input
                            type="file"
                            class="form-control"
                            name="image"
                            (change)="onImageSelected($event)"
                        >
                        </div>
                                              <!-- Description -->
                        <div class="col-12">
                        <label class="form-label">Description</label>
                        <textarea
                            class="form-control"
                            rows="4"
                            placeholder="Description du produit"
                            [(ngModel)]="productForm.description"
                            name="description"
                        ></textarea>
                        </div>

                        <!-- Unité de base -->
                        <div class="col-12 col-md-6">
                        <label class="form-label">Unité de base</label>
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Ex: prestation , kg, litre"
                            [(ngModel)]="productForm.base_unity"
                            name="base_unity"
                        >
                        </div>
                    <!-- Quantité-->
                        <div class="col-12 col-md-6">
                        <label class="form-label">Quantité minimale de commande</label>
                        <input
                            type="text"
                            class="form-control"
                            placeholder="Ex: 1, 20, 100"
                            [(ngModel)]="productForm.min_quantity"
                            name="base_unity"
                        >
                        </div>
                    </div>

                    <!-- Attributs dynamiques -->
                    <hr class="my-4">

                    <h5>Attributs spécifiques (optionnel)</h5>
                    <div class="row g-3 align-items-end mb-2" *ngFor="let attr of attributes; let i= index">
                        <div class="col-md-5">
                        <label class="form-label">Clé</label>
                        <input type="text" class="form-control" [(ngModel)]="attributes[i].key"
                        placeholder="Ex: Marque, Couleur ..."
                        [name]="'attr_key_' + i">
                        </div>
                        <div class="col-md-5">
                        <label class="form-label">Valeur</label>
                        <input type="text" class="form-control" [(ngModel)]="attributes[i].value"
                        placeholder="Ex: Samsung, Rouge ..."
                        [name]="'attr_value_' + i">
                        </div>
                        <div class="col-md-2 d-flex gap-2">
                        <button type="button" class="btn btn-outline-primary w-50"
                        (click)="addAttributeRow()">+</button>
                        <button type="button" class="btn btn-outline-danger w-50"
                        (click)="removeAttributeRow(i)">-</button>
                        </div>
                        </div>
                    <!-- Boutons -->
                    <div class="mt-4 text-end">
                        <button type="reset" class="btn btn-outline-secondary me-2">
                        Annuler
                        </button>
                        <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
                        {{ isSubmitting ? 'Enregistrement...' : 'Enregistrer le produit' }}
                        </button>
                    </div>

                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
